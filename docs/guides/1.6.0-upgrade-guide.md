---
layout: "couchbase-capella"
page_title: "Couchbase Capella Provider 1.6.0: Upgrade and Information Guide"
sidebar_current: "docs-couchbase-capella-guides-160-upgrade-guide"
description: |-
Couchbase Capella Provider 1.6.0: Upgrade and Information Guide
---

# Couchbase Capella Provider 1.6.0: Upgrade and Information Guide

Here is a list of what's new in 1.6.0

## New Features

### App Endpoints

Version 1.6.0 introduces comprehensive support for Couchbase Capella App Endpoints, allowing you to configure mobile and edge data synchronization directly through Terraform.

App Endpoints are logical entities that define how Couchbase Lite clients connect to and sync data with your Couchbase cluster through App Services. Each App Endpoint represents a distinct configuration that controls authentication, data access, CORS policies, and sync behavior for a specific set of clients. You can now manage these endpoint configurations, including authentication providers, CORS settings, and access control functions, as Terraform resources.

**New Resources:**
* [`couchbase-capella_app_endpoint`](https://registry.terraform.io/providers/couchbasecloud/couchbase-capella/latest/docs/resources/app_endpoint) - Create and manage app endpoints
* [`couchbase-capella_app_endpoint_activation_status`](https://registry.terraform.io/providers/couchbasecloud/couchbase-capella/latest/docs/resources/app_endpoint_activation_status) - Control endpoint activation state
* [`couchbase-capella_app_endpoint_cors`](https://registry.terraform.io/providers/couchbasecloud/couchbase-capella/latest/docs/resources/app_endpoint_cors) - Configure CORS settings
* [`couchbase-capella_app_endpoint_oidc_provider`](https://registry.terraform.io/providers/couchbasecloud/couchbase-capella/latest/docs/resources/app_endpoint_oidc_provider) - Configure OIDC authentication providers
* [`couchbase-capella_app_endpoint_default_oidc_provider`](https://registry.terraform.io/providers/couchbasecloud/couchbase-capella/latest/docs/resources/app_endpoint_default_oidc_provider) - Set default OIDC provider
* [`couchbase-capella_app_endpoint_access_control_function`](https://registry.terraform.io/providers/couchbasecloud/couchbase-capella/latest/docs/resources/app_endpoint_access_control_function) - Define access control logic
* [`couchbase-capella_app_endpoint_import_filter`](https://registry.terraform.io/providers/couchbasecloud/couchbase-capella/latest/docs/resources/app_endpoint_import_filter) - Configure import filters

**New Data Sources:**
* [`couchbase-capella_app_endpoint`](https://registry.terraform.io/providers/couchbasecloud/couchbase-capella/latest/docs/data-sources/app_endpoint) - Retrieve a single app endpoint
* [`couchbase-capella_app_endpoints`](https://registry.terraform.io/providers/couchbasecloud/couchbase-capella/latest/docs/data-sources/app_endpoints) - List app endpoints (supports filtering by name)
* [`couchbase-capella_app_endpoint_activation_status`](https://registry.terraform.io/providers/couchbasecloud/couchbase-capella/latest/docs/data-sources/app_endpoint_activation_status) - Check endpoint activation state

Example - Creating an app endpoint with OIDC authentication and CORS:

```terraform
resource "couchbase-capella_app_endpoint" "mobile_sync" {
  organization_id = var.organization_id
  project_id      = var.project_id
  cluster_id      = var.cluster_id
  app_service_id  = var.app_service_id
  name            = "mobile-endpoint"
  bucket          = "mobile-data"
  
  scopes = {
    "mobile_scope" = {
      collections = {
        "user_data" = {
          access_control_function = "function (doc, oldDoc, meta) { channel(doc.userId); }"
          import_filter           = ""
        }
      }
    }
  }

  oidc = [
    {
      client_id = "my-app-client"
      issuer    = "https://accounts.google.com"
      register  = true
    }
  ]
  
  cors = {
    disabled = false
    origin   = ["https://myapp.example.com"]
    headers  = ["Authorization", "Content-Type"]
    max_age  = 3600
  }
}
```

Example - Configuring CORS for an existing endpoint:

```terraform
resource "couchbase-capella_app_endpoint_cors" "mobile_cors" {
  organization_id   = var.organization_id
  project_id        = var.project_id
  cluster_id        = var.cluster_id
  app_service_id    = var.app_service_id
  app_endpoint_name = "mobile-endpoint"

  origin       = ["https://app.example.com", "https://admin.example.com"]
  login_origin = ["https://login.example.com"]
  headers      = ["Authorization", "Content-Type", "X-Custom-Header"]
  max_age      = 86400
  disabled     = false
}
```

Example - Adding OIDC provider:

```terraform
resource "couchbase-capella_app_endpoint_oidc_provider" "google_auth" {
  organization_id   = var.organization_id
  project_id        = var.project_id
  cluster_id        = var.cluster_id
  app_service_id    = var.app_service_id
  app_endpoint_name = "mobile-endpoint"

  issuer     = "https://accounts.google.com"
  client_id  = "my-google-client-id"
  register   = true
  
  discovery_url  = "https://accounts.google.com/.well-known/openid-configuration"
  roles_claim    = "roles"
  username_claim = "email"
}
```

**Additional Examples:**

For comprehensive examples of all App Endpoint features, see:

* [App Endpoint](https://github.com/couchbasecloud/terraform-provider-couchbase-capella/tree/main/examples/app_endpoint) - Basic endpoint creation and management
* [App Endpoint Activation Status](https://github.com/couchbasecloud/terraform-provider-couchbase-capella/tree/main/examples/app_endpoint_activation_status) - Managing endpoint activation state
* [App Endpoint CORS](https://github.com/couchbasecloud/terraform-provider-couchbase-capella/tree/main/examples/app_endpoint_cors) - Configuring Cross-Origin Resource Sharing
* [App Endpoint OIDC Provider](https://github.com/couchbasecloud/terraform-provider-couchbase-capella/tree/main/examples/app_endpoint_oidc_provider) - Setting up OpenID Connect authentication
* [App Endpoint Default OIDC Provider](https://github.com/couchbasecloud/terraform-provider-couchbase-capella/tree/main/examples/app_endpoint_default_oidc_provider) - Configuring default OIDC provider
* [App Endpoint Access Control Function](https://github.com/couchbasecloud/terraform-provider-couchbase-capella/tree/main/examples/app_endpoint_access_control_function) - Defining custom access control logic
* [App Endpoint Import Filter](https://github.com/couchbasecloud/terraform-provider-couchbase-capella/tree/main/examples/import_filter) - Configuring data import filtering

### Enhanced Documentation

* **OpenAPI Integration**: Provider documentation now automatically includes field descriptions extracted from the Capella Management API OpenAPI specification, providing richer inline documentation for all resources and data sources.
* **Improved Resource Documentation**: Added comprehensive markdown descriptions to all resources for better clarity in the Terraform Registry.

Related PRs:
* [#436](https://github.com/couchbasecloud/terraform-provider-couchbase-capella/pull/436) - Generate Enhanced Documentation
* [#435](https://github.com/couchbasecloud/terraform-provider-couchbase-capella/pull/435) - Migrate docs to use OpenAPI documentation (Part 3)
* [#434](https://github.com/couchbasecloud/terraform-provider-couchbase-capella/pull/434) - Migrate docs to use OpenAPI documentation (Part 2)
* [#433](https://github.com/couchbasecloud/terraform-provider-couchbase-capella/pull/433) - Migrate docs to use OpenAPI documentation (Part 1)
* [#423](https://github.com/couchbasecloud/terraform-provider-couchbase-capella/pull/423) - Improved Documentation

### API Enhancements

* **V2 API Client**: Introduced a generated OpenAPI v2 client alongside the existing v1 client, enabling a gradual migration path to the newer API version. ([#404](https://github.com/couchbasecloud/terraform-provider-couchbase-capella/pull/404))
* **Rate Limiting Visibility**: The provider now logs when API rate limiting is encountered, improving troubleshooting and monitoring. ([#406](https://github.com/couchbasecloud/terraform-provider-couchbase-capella/pull/406))

### Cluster Configuration

* **Configurable vBuckets**: Added support for configuring the number of vBuckets per bucket. ([#405](https://github.com/couchbasecloud/terraform-provider-couchbase-capella/pull/405))

## Bug Fixes

* **App Services CIDR**: Fixed field requirement validation and error handling for allowed CIDRs in App Services ([#432](https://github.com/couchbasecloud/terraform-provider-couchbase-capella/pull/432))
* **Private Endpoints**: Added service name field to private endpoints resource and datasource ([#431](https://github.com/couchbasecloud/terraform-provider-couchbase-capella/pull/431))
* **Bucket Defaults**: Provider no longer incorrectly sets default values for buckets that should be server-determined ([#402](https://github.com/couchbasecloud/terraform-provider-couchbase-capella/pull/402))
* **API Key Rotation**: 
  * Fixed response struct to include the usable token ([#382](https://github.com/couchbasecloud/terraform-provider-couchbase-capella/pull/382))
  * Changed success status code from 201 to 200 ([#374](https://github.com/couchbasecloud/terraform-provider-couchbase-capella/pull/374))
* **Cluster Import**: Removed duplicate cluster_id argument from import command documentation ([#377](https://github.com/couchbasecloud/terraform-provider-couchbase-capella/pull/377))
* **If-Match Header**: Dynamically set if_match header for proper resource updates ([#370](https://github.com/couchbasecloud/terraform-provider-couchbase-capella/pull/370))

## Changes

There are no deprecations as part of this release.

1.6.0 includes new features and general improvements. See the [CHANGELOG](https://github.com/couchbasecloud/terraform-provider-couchbase-capella/blob/master/CHANGELOG.md) for more specific information.

### New Resources and Data Sources

* Manage App Endpoints [`couchbase-capella_app_endpoint`](https://registry.terraform.io/providers/couchbasecloud/couchbase-capella/latest/docs/resources/app_endpoint)
* Retrieve App Endpoints [`couchbase-capella_app_endpoints`](https://registry.terraform.io/providers/couchbasecloud/couchbase-capella/latest/docs/data-sources/app_endpoints)
* Manage App Endpoint Activation Status [`couchbase-capella_app_endpoint_activation_status`](https://registry.terraform.io/providers/couchbasecloud/couchbase-capella/latest/docs/resources/app_endpoint_activation_status)
* Manage App Endpoint CORS [`couchbase-capella_app_endpoint_cors`](https://registry.terraform.io/providers/couchbasecloud/couchbase-capella/latest/docs/resources/app_endpoint_cors)
* Manage App Endpoint OIDC Provider [`couchbase-capella_app_endpoint_oidc_provider`](https://registry.terraform.io/providers/couchbasecloud/couchbase-capella/latest/docs/resources/app_endpoint_oidc_provider)
* Manage App Endpoint Access Control Function [`couchbase-capella_app_endpoint_access_control_function`](https://registry.terraform.io/providers/couchbasecloud/couchbase-capella/latest/docs/resources/app_endpoint_access_control_function)

## Notes

### Migration from Older Versions

If you're upgrading from an earlier version of the provider:

1. **App Endpoints**: If you were previously managing Sync Gateway configurations outside of Terraform, you can now import them as `couchbase-capella_app_endpoint` resources.
2. **Private Endpoints**: The `service_name` field has been added to private endpoint resources and data sources. Existing configurations will continue to work without changes. If you need to access the `service_name` property, you can now reference it in your configurations.
3. **Bucket Configuration**: With the removal of automatic default-setting behavior, ensure your bucket configurations explicitly specify all required fields.

### Helpful Links

- [Getting Started with the Terraform Provider](https://github.com/couchbasecloud/terraform-provider-couchbase-capella/blob/master/examples/getting_started)
- [Capella Management API v4.0](https://docs.couchbase.com/cloud/management-api-reference/index.html)
- [See Specific Examples](https://github.com/couchbasecloud/terraform-provider-couchbase-capella/blob/master/examples)
